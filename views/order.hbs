<style>
        .form-group {
            width: 960px;
            margin: 50px auto;
            font-size: 15px;
            border-radius: 2px;
        }
        .form-group form {
            margin-bottom: 15px;
            background: #f7f7f7;
            box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
            padding: 30px;
        }
        .form-group h2 {
            margin: 0 0 15px;
        }
        .form-input, .btn {
            min-height: 38px;
            border-radius: 2px;
        }
        h3{
            color: rgb(25, 148, 214)
        }
        .select{
            width: 100%;
            min-height: 38px;
            border-radius: 2px;
        }
        .form-input{
            width: 100%;
            min-height: 38px;
            border-radius: 2px;
        }
        .btn-continue{
            width: 200px;
            margin-left: 510px;
            font-size: 30px;
            background-color: #1e90ff ;
            border-radius: 1px;
            border-color: white;
        }
        .white{
            margin-top: 10px;
            margin-bottom: 10px;
            color:white;
            text-align: center;
        }
    </style>
<form>
    <div class="form-group">
            <h3>THÔNG TIN NGƯỜI TIÊM</h3>
            <div class="row">
                <div class="col-4">
                    <h5>Họ và Tên</h5>
                </div>
                <div class="col-8">
                    <h5>Mối quan hệ</h5>
                    <p>Khách hàng chỉ được đăng ký tiêm cho người thân nếu thuộc các mối quan hệ sau</p>
                </div>
            </div>
            <div class="row">
                <div class="col-4">
                    <input type="text" class="form-input" name="name" id="name" placeholder="Your Name" required>
                </div>
                <div class="col-4">
                    <select class="select">                           
                        <option value="01">Cha</option>
                        <option value="02">Mẹ</option>
                        <option value="03">Ông</option>
                        <option value="04">Bà</option>
                        <option value="04">Anh</option>
                        <option value="04">Chị</option>
                        <option value="04">Em</option>
                    </select>
                </div>
            </div>
            <div class="row">
                <div class="col-4">
                <h5>Ngày Sinh</h5>
                <input type="date" class="form-input" name="DOB" id="DOB" required>
                </div>
                <div class="col-4">
                <h5>Giới Tính</h5>
                <input type="radio" name="gender" value="Nam" checked> Nam<br>
                <input type="radio" name="gender" value="Nu"> Nữ<br>
                </div>
            </div>
            <div class="row">
                <div class="col-4">
                <h5>Số Điện Thoại</h5>
                <input type="phone" class="form-input" name="phone" id="phone" placeholder="Your Phone" required>
                </div>
                <div class="col-4">
                    <h5>Email</h5>
                    <input type="email" class="form-input" name="email" id="email" placeholder="Your Email" required>
                </div>
            </div>
            <div class="row">
                <div class="col-8">
                    <h5>Số nhà - Tên Đường</h5>
                    <input type="address" class="form-input" name="address" id="address" placeholder="Your address" required>
                </div> 
            </div>    
            <div class="row">
                <div class="col-md-4">
                    <label for="inputCity">Tỉnh thành (*)</label>
                    <select class="select" id="citySelect" onchange="choosedCity()">
                        <option>Chọn Tỉnh</option>
                        {{#each locations}}
                        <option value="{{this.code}}">{{this.name}}</option>
                        {{/each}}
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="inputDistrict">Quận huyện (*)</label>
                    <select class="select" id="district" onchange="choosedDistrict()">
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="inputWard">Phường xã (*)</label>
                    <select class="select" id="ward">
                    </select>
                </div>
            </div><br />
    </div>
    <div class="form-group">
        <h3>CHỌN ĐỊA ĐIỂM MONG MUỐN TIÊM</h3>
        <div class="row">
            <div class="col-md-4">
                <label for="inputNameFamily">Trung tâm VNVC mong muốn tiêm (*)</label>
                <select class="select" id="branch">
                    <option>Chọn cơ sở</option>
                    {{#each branchs}}
                    <option value="{{this._id}}">{{this.name}}</option>
                    {{/each}}
                </select>
            </div>
        </div><br />
        <div class="row">
            <div class="col-md-6">
                <label for="inputBirtDay">Ngày mong muốn tiêm (*)</label>
                <input type="datetime-local" class="form-input" id="birtd">
            </div>
        </div><br />
    </div>
    <div class="form-group">
    <h3>CHỌN THÊM LOẠI VẮC XIN</h3>
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="inputAddress">Loại vắc xin muốn đăng ký (*)</label>
                        <div class="custom-control custom-radio">
                            <input type="radio" class="custom-control-input" id="0" value="0" name="radio-stacked" onclick="handleClick(this);">
                            <label class="custom-control-label" for="customControlValidation2">Vắc xin gói</label>
                        </div>
                        <div class="custom-control custom-radio mb-3">
                            <input type="radio" class="custom-control-input" id="1" value="1" name="radio-stacked" onclick="handleClick(this);">
                            <label class="custom-control-label" for="customControlValidation3">Vắc xin lẻ</label>
                        </div>
                    </div>
                </div>
            </div>
            <div id="vaccineListGroup" style="display: none;">
            </div>
            <div id="vaccineListSingle" style="display: none;">
            </div> <br />   
            <button type="submit" class="btn btn-success">Hoàn thành đăng ký</button>
        </div>
</form>
<script>
    let cityCode = 1
    function choosedCity() {
        let idCity =  document.getElementById("citySelect").value;
        fetch('https://provinces.open-api.vn/api/d/')
            .then(response => response.json())
            .then(data => {
                let districts = data.filter(item => item.province_code == idCity)
                let districtsHTML = ""
                for (let district of districts) {
                    districtsHTML += `<option value="${district.code}">${district.name}</option>`
                }
                document.getElementById("district").innerHTML = districtsHTML
            });
        
    }

    function choosedDistrict() {
        let idDistrict =  document.getElementById("district").value;
        fetch('https://provinces.open-api.vn/api/w/')
            .then(response => response.json())
            .then(data => {
                let wards = data.filter(item => item.district_code == idDistrict)
                let wardsHTML = ""
                for (let ward of wards) {
                    wardsHTML += `<option value="${ward.code}">${ward.name}</option>`
                }
                document.getElementById("ward").innerHTML = wardsHTML
            });
    }

    function handleClick(event) {
        if(event.value === "0"){
            document.getElementById('vaccineListGroup').style.display = "block"
            document.getElementById('vaccineListSingle').style.display = "none"
            fetch('http://localhost:3000/category/listAndVaccineListIsGroup')
            .then(response => response.json())
            .then(data => {
                let groupHTML = ""
                for (let category of data) {
                    let title = `
                    <div class="row" ><b>${category.name}</b></div>
                    <div class="row"> `
                    let content = ""
                    for (let vaccine of category.vacciniesList){
                        content += `
                            <div class="col-md-4" style="border-style: ridge;">
                                <input type="checkbox"/>
                                <div>${vaccine.name} - ${vaccine.price} VND</div>
                            </div>
                        `
                    }
                    let footer = `</div>`
                    let HTML = title + content + footer
                    groupHTML += HTML
                }
                document.getElementById("vaccineListGroup").innerHTML = groupHTML
            });
        }else{
            document.getElementById('vaccineListSingle').style.display = "block"
            document.getElementById('vaccineListGroup').style.display = "none"
            fetch('http://localhost:3000/vaccine/getByType/1')
            .then(response => response.json())
            .then(data => {
                let groupHTML = `<div class="row">`
                for (let vaccine of data) {
                    groupHTML += `
                            <div class="col-md-4" style="border-style: ridge;">
                                <input type="checkbox"/>
                                <div>${vaccine.name} - ${vaccine.price} VND</div>
                            </div>
                    `
                }
                groupHTML += `</div>`
                    document.getElementById("vaccineListSingle").innerHTML = groupHTML
            });
        
        }
    }

</script>